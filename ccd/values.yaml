tags:
  ccd-idam-pr: true
  rpe-service-auth-provider: false

ccd-user-profile-api:
  java:
    releaseNameOverride: ccd-user-profile
    image: 'hmctspublic.azurecr.io/ccd/user-profile-api:latest'
    environment:
      USER_PROFILE_DB_NAME: "user-profile"
      USER_PROFILE_DB_USERNAME: "hmcts"
      USER_PROFILE_DB_PASSWORD: "hmcts"
      IDAM_S2S_URL: http://service-auth-s2s
  postgres:
    enabled: true

ccd-definition-store-api:
  java:
    image: 'hmctspublic.azurecr.io/ccd/definition-store-api:latest'
    releaseNameOverride: ccd-definition-store
    keyVaults:
      s2s:
        resourceGroup: rpe-service-auth-provider
        secrets:
          - microservicekey-ccd-definition
    environment:
      IDAM_S2S_URL: http://ccd-test-stubs-service
      DEFINITION_STORE_DB_NAME: definition-store
      DEFINITION_STORE_DB_USERNAME: "hmcts"
      DEFINITION_STORE_DB_PASSWORD: "hmcts"
      USER_PROFILE_HOST: http://ccd-user-profile
  postgres:
    enabled: true    

ccd-data-store-api:
  java:
    image: 'hmctspublic.azurecr.io/ccd/data-store-api:latest'
    releaseNameOverride: ccd-data-store
    environment:
      DATA_STORE_DB_NAME: "data-store"
      DATA_STORE_DB_USERNAME: "hmcts"
      DATA_STORE_DB_PASSWORD: "hmcts"
      CCD_DM_DOMAIN: https?://dm-store.*
      IDAM_USER_URL: https://ccd-test-stubs-service/login
      IDAM_S2S_URL: http://service-auth-s2s
      DEFINITION_STORE_HOST: http://ccd-definition-store
      USER_PROFILE_HOST: http://ccd-user-profile
      CCD_DM_DOMAIN: ^https?://(?:api-gateway\\.preprod\\.dm\\.reform\\.hmcts\\.net|dm-store-aat\\.service\\.core-compute-aat\\.internal(?::\\d+)?)
      CCD_DRAFT_STORE_URL: http://draft-store-service-aat.service.core-compute-aat.internal
  postgresql:
     enabled: true

ccd-api-gateway-web:
  nodejs:
    enabled: false
    image: 'hmctspublic.azurecr.io/ccd/api-gateway-web:latest'
    releaseNameOverride: ccd-api-gateway
    environment:
      IDAM_OAUTH2_CLIENT_ID: ccd_gateway
      IDAM_OAUTH2_TOKEN_ENDPOINT: http://ccd-test-stubs-service/oauth2/token
      IDAM_OAUTH2_LOGOUT_ENDPOINT: http://ccd-test-stubs-service/session/:token
      IDAM_BASE_URL: http://ccd-test-stubs-service
      IDAM_S2S_URL: http://service-auth-s2s
      PROXY_AGGREGATED: http://ccd-data-store
      PROXY_DATA: http://ccd-data-store
      PROXY_DEFINITION_IMPORT: http://ccd-definition-store-api
      PROXY_DOCUMENT_MANAGEMENT: http://dm-store-aat.service.core-compute-aat.internal
      PROXY_PAYMENTS: http://payment-api-aat.service.core-compute-aat.internal
      PROXY_PRINT_SERVICE: http://ccd-case-print-service-aat.service.core-compute-aat.internal

ccd-admin-web:
  nodejs:
    enabled: true
    image: 'hmctspublic.azurecr.io/ccd/admin-web:latest'
    releaseNameOverride: "ccd-admin-web"
    environment:
      IDAM_S2S_URL: http://service-auth-s2s
      IDAM_BASE_URL: https://idam-api.aat.platform.hmcts.net
      IDAM_OAUTH2_TOKEN_ENDPOINT: https://idam-api.aat.platform.hmcts.net/oauth2/token
      IDAM_OAUTH2_LOGOUT_ENDPOINT: https://idam-api.aat.platform.hmcts.net/session/:token
  idam-pr:
    releaseNameOverride: ccd-idam-pr
    redirect_uris:
      CCD:
        - https://ccd-admin-web/oauth2redirect

ccd-case-management-web:
  nodejs:
    enabled: true
    image: 'hmctspublic.azurecr.io/ccd/case-management-web:latest'
    releaseNameOverride: "ccd-case-management-web"
    environment:
      IDAM_LOGIN_URL: https://ccd-test-stubs-service
      CCD_GW_LOGOUT_URL: https://gateway-ccd.aat.platform.hmcts.net/logout
      CCD_API_URL: https://gateway-ccd.aat.platform.hmcts.net/aggregated
      CCD_DATA_URL: https://gateway-ccd.aat.platform.hmcts.net/data
      CCD_GW_OAUTH2_URL: https://gateway-ccd.aat.platform.hmcts.net/oauth2
      DM_URL: https://gateway-ccd.aat.platform.hmcts.net/documents
      PRINT_SERVICE_URL: https://gateway-ccd.aat.platform.hmcts.net/print
      PRINT_SERVICE_URL_REMOTE: https://return-case-doc-ccd.nonprod.platform.hmcts.net
      CCD_ACTIVITY_URL: https://gateway-ccd.aat.platform.hmcts.net/activity
      PAYMENTS_URL: https://gateway-ccd.aat.platform.hmcts.net/payments
  idam-pr:
    redirect_uris:
      CCD:
        - https://ccd-case-management-web/oauth2redirect

rpe-service-auth-provider:
  enabled: true
  java:
    image: hmctspublic.azurecr.io/rpe/service-auth-provider:latest
    releaseNameOverride: 'service-auth-s2s'
    ingressHost: ccd-s2s
    readinessDelay: 180
    livenessDelay: 180
    readinessPeriod: 60
    livenessPeriod: 60
    keyVaults:
    environment:
      TESTING_SUPPORT_ENABLED: 'true'
      MICROSERVICEKEYS_CCD_ADMIN: AAAAAAAAAAAAAAAA
      MICROSERVICEKEYS_CCD_DATA: AAAAAAAAAAAAAAAA
      MICROSERVICEKEYS_CCD_DEFINITION: AAAAAAAAAAAAAAAA
      MICROSERVICEKEYS_CCD_GATEWAY: AAAAAAAAAAAAAAAA
      MICROSERVICEKEYS_CCD_GW: AAAAAAAAAAAAAAAA
      MICROSERVICEKEYS_FPL_CASE_SERVICE: AAAAAAAAAAAAAAAA

postgresql:
  resources:
    requests:
      cpu: 25m
  initdbScripts:
    init.sql: |-
      CREATE DATABASE "data-store" WITH OWNER = hmcts ENCODING = 'UTF-8' CONNECTION LIMIT = -1;
      CREATE DATABASE "definition-store" WITH OWNER = hmcts ENCODING = 'UTF-8' CONNECTION LIMIT = -1;
  postgresqlUsername: hmcts
  postgresqlPassword: hmcts
  postgresqlDatabase: user-profile

